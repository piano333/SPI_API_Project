This is the original source code from Kalyanrama, before we made any modifications at all.